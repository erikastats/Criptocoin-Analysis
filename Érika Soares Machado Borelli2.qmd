---
title: "Análise de crescimento de operações e produtos BIPA"
author: "Érika Soares Machado Borelli"
format: 
  pdf:
    out-width: "90%"
    fig-align: center
    include-in-header:
      text: |
        \usepackage{fvextra}
        \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,breakanywhere,commandchars=\\\{\}}
editor: visual
---

## Introdução

O objetivo deste desafio é avaliar como as operações e produtos da Bipa contribuem para o crescimento da empresa, utilizando dados simulados que representam operações reais da plataforma. Para isso, será proposta uma métrica que reflita de forma consistente esse crescimento e que gere insights acionáveis para orientar decisões estratégicas.

Esse tipo de análise é fundamental para medir o sucesso da plataforma, identificar oportunidades de monetização e garantir um crescimento sustentável.

Após uma etapa de exploração e entendimento dos dados , com atenção à consistência das informações e à jornada dos usuários, definiu-se como métrica principal o **Growth Rate de utilização dos produtos e operações**. Essa métrica mede a taxa de crescimento do número de usuários ativos que realizam transações nos diferentes produtos internos da Bipa, permitindo avaliar tanto a **ampliação da base engajada** quanto o **aumento da profundidade de uso** ao longo do tempo.

A escolha se justifica por dois fatores estratégicos: além de refletir diretamente o nível de adoção e retenção dos produtos, o aumento no uso está fortemente correlacionado ao crescimento finaneiro, uma vez que usuários mais engajados tendem a transacionar valores maiores, utilizar mias serviços e contribuir de forma mais consistente para a receita da empresa.

## Métrica principal - Growth Rate de Base Engajada

Para este desafio usaremos a Growth Rate, ou Taxa de Crescimento. Ela é um indicador percentual que mede o aumento de um valor ao longo do tempo.

$$ \text{Growth Rate} = \frac{U_{\text{Período Atual}} - U_{\text{Período Anterior}}}{U_{\text{Período Anterior}}} \times 100 $$

Onde:

-   $U_{Período}$ = número de usuários ativos no período, considerando apenas aqueles que realizaram pelo menos uma das seguintes ações:

    -   Criar um cartão;

    -   Realizar uam compra com cartão;

    -   Enviar ou receber uam transferência interna;

    -   Criar um *quote* ou executar um *order*;

    -   Realizar um PIX.

**Critérios de cálculo:**

1.  A métrica será calculada em frequência mensal e anual (quando possível).
2.  Serão considerados apenas meses com registros efetivos de atividade para evitar distorções.
3.  Usuários serão considerados inativos a partir da data de sua última ação registrada e não entrarão nos períodos subsequentes.

Essa definição garante que a taxa de crescimento reflita variações reais na base engajada, e naõ apenas oscilações na base total de caastros ou períodos sem dados relevantes.

## Resultados

```{r bibliotecas}
#| include: true
#| message: false
#| error: false
#| echo: false

# Bibliotecas
library(gt)
library(ggplot2)
library(hrbrthemes)
library(dplyr)
library(tidyr)
library(scales)

# Importando banco de dados
source("ccreating_db.R")

# Importando funções
source("funcoes_ciptocoin_analysis.R")

# Importando tables
source("build_tables.R")
```

#### 1. Growth Rate geral da base engajada (mensal)

```{r Q1}
#| message: false
#| error: false
#| echo: false
#| warning: false 
Q1 = query_growth_rate_geral( timeformat = "%Y-%m",
                              colname = "month",
                              title = "mês"
                              )

cum_month <- query_data(Q1)
growth_metric_plot(df = cum_month,
                   xtitle = "Mês",
                   plottitle = "Crescimento mensal de usuários BIPA",
                   xcolname = "month",
                   caption_text = "Fonte: Query Q1 (Apêndice A) - cálculo de novos usuários e growth mensal")

```

O gráfico mostra que, ao longo do tempo, a quantidade absoluta de novos usuários se manteve relativamente constante, com exceção de novembro de 2024, quando houve um pico no número de cadastros. No entanto, como a base de usuários acumulada cresce a cada período, a taxa percentual de crescimento tende a diminuir. Isso é esperado em bases com crescimento linear, mas acumulativo. Mesmo com novos usuários entrando, o impacto relativo em relação ao total é cada vez menor.

#### 2. Growth Rate geral da base engajada (anual)

```{r Q2}
#| message: false
#| error: false
#| echo: false
#| warning: false 
Q2 = query_growth_rate_geral( timeformat = "%Y",
                              colname = "year",
                              title = "ano"
                              )

cum_year <- query_data(Q2)
growth_metric_plot(df = cum_year,
                   xtitle = "Ano",
                   plottitle = "Crescimento anual de usuários BIPA",
                   xcolname = "year",
                   caption_text = "Fonte: Query Q2 (Apêndice A) - cálculo de novos usuários e growth anual")
```

A análise anual reforça a tendência de queda na taxa de crescimento da base de usuários da BIPA. Apesar de o número absoluto de novos usuários ter se mantido estável em 2024 e 2025, o crescimento líquido em 2025 foi nulo, devido à inativação de dois usuários, o mesmo número de novos cadastros registrados no ano.

Essa desaceleração constante nas taxas de crescimento, apesar do número relativo absoluto de novos usuários se matner relativament estável, sugere que a base total está crescendo lentamente ou até se estagnando. O que indica uma possível saturação do público-alvo, redução de aquisição de novos clientes ou desafios em estratégias de retenção e atração.

#### 3. Engajamento por produto - primeira adoção

Mede o momento em que cada usuário usa o produto pela primeira vez

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 


adocao <- bind_rows(
  mutate(cum_month_card,        produto = "Cartão (Q3)"),
  mutate(cum_purchase,          produto = "Compra no cartão (Q6)"),
  mutate(cum_PIX_user,          produto = "PIX (Q9)"),
  mutate(cum_transaction_user,  produto = "Transf. interna (Q12)"),
  mutate(cum_quotes_user,       produto = "Quote (Q15)"),
  mutate(cum_orders_user,       produto = "Order (Q18)")
) |>
  mutate(month = as.Date(paste0(month, "-01"))) |>
  group_by(produto) |>
  mutate(
    max_bar = max(new_users_count, na.rm = TRUE),
    max_gr  = max(growth_rate_percent, na.rm = TRUE),
    scale   = ifelse(is.finite(max_bar/max_gr) & max_gr > 0, max_bar/max_gr, 1),
    growth_scaled = growth_rate_percent * scale
  ) |>
  ungroup()

facet_plot(adocao, 'new_users_count', "Novos usuários", "Fonte: Q3, Q6, Q9, Q12, Q15, Q18 (Apêndice A)", "Primeira adoção - Engajamento por produto ")

```

1.  **Picos iniciais seguidos de queda acentuada** - A maioria dos produtos apresentou crescimento na primeira adoção nos primeiros meses, mas houve forte retração subsequente, sugerindo que o lançamento ou campanhas iniciais atraíram mais usuários do que períodos posteriores.

2.  **Produtos com baixa recorrência de adoção** - “Compra no cartão” e “Orders” mostram números absolutos baixos e pouco crescimento ao longo do tempo, indicando que poucos novos usuários aderem mensalmente a essas funcionalidades.

3.  **Diferentes padrões de retenção pós-adoção** - O PIX e as transferências internas, apesar de quedas no growth rate, mantêm um número absoluto de novos usuários relativamente constante em alguns meses, sugerindo potencial de estabilização da adoção.

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 

average_plot_gr(adocao, "Média do Growth Rate - Primeira adoção (por produto)", "Fonte: Q3, Q6, Q9, Q12, Q15, Q18 (Apêndice A)")

```

A média do Growth Rate oferece uma visão comparativa sobre o desempenho relativo de cada produto na atração de novos usuários ao longo do tempo. Apesar de ser influenciada por picos iniciais, comuns na primeira adoção, quando o crescimento tende a ser mais acentuado, a métrica ainda é útil para identificar quais produtos funcionam como principais portas de entrada para a base de clientes. Produtos com maior média de crescimento, como Cartão e Quote, indicam forte potencial de aquisição inicial, podendo ser priorizados em estratégias de marketing e campanhas de ativação. Já produtos com médias mais baixas, como Transferência interna, podem demandar ações específicas para aumentar sua atratividade e ampliar sua contribuição no crescimento da empresa.

#### 4. Engajamento por novos eventos

Mede o volume de novos registros/ações (cartões emitidos, compras realizadas, etc). Pode incluir ações repetidas de um mesmo usuário.

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
#| 
# Vetor com os nomes dos dataframes
df_names <- c(
  "cum_month_card_id", 
  "cum_purchase_id", 
  "cum_PIX", 
  "cum_transaction", 
  "cum_quotes", 
  "cum_order"
)

# Novo nome da coluna 2
novo_nome <- "new_ones_count"

# Loop para renomear diretamente no ambiente
for (nm in df_names) {
  df <- get(nm)          # pega o dataframe pelo nome
  names(df)[3] <- novo_nome
  assign(nm, df, envir = .GlobalEnv)  # salva de volta no ambiente global
}

novos_eventos <- bind_rows(
  mutate(cum_month_card_id,        produto = "Cartão (Q4)"),
  mutate(cum_purchase_id,          produto = "Compra no cartão (Q7)"),
  mutate(cum_PIX,          produto = "PIX (Q10)"),
  mutate(cum_transaction,  produto = "Transf. interna (Q13)"),
  mutate(cum_quotes,       produto = "Quote (Q16)"),
  mutate(cum_order,       produto = "Order (Q19)")
) |>
  mutate(month = as.Date(paste0(month, "-01"))) |>
  group_by(produto) |>
  mutate(
    max_bar = max(new_ones_count, na.rm = TRUE),
    max_gr  = max(growth_rate_percent, na.rm = TRUE),
    scale   = ifelse(is.finite(max_bar/max_gr) & max_gr > 0, max_bar/max_gr, 1),
    growth_scaled = growth_rate_percent * scale
  ) |>
  ungroup()

facet_plot(novos_eventos, 'new_ones_count', "Novos eventos", "Fonte: Q4, Q7, Q10, Q13, Q16, Q19 (Apêndice A)", "Novos eventos - Engajamento por produto")
```

1.  **Crescimento inicial elevado e depois desaceleração** -Todos os produtos apresentam *growth rate* muito alto no primeiro período (até 200%), caindo rapidamente nos meses seguintes, sinalizando estabilização natural conforme a base cresce.

2.  **Maior engajamento em alguns produtos** - *Quote (Q16)* e *PIX (Q10)* se destacam pelo maior volume absoluto de novos eventos, mantendo participação relevante mesmo com queda percentual.

3.  **Potencial para ações de estímulo** - Produtos como *Cartão (Q4)* e *Order (Q19)* mostram engajamento mais limitado após os meses iniciais, sugerindo oportunidade para campanhas ou melhorias para incentivar novos eventos.

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 

average_plot_gr(novos_eventos, "Média do Growth Rate - Novos Eventos",  "Fonte: Q4, Q7, Q10, Q13, Q16, Q19 (Apêndice A)")
```

A média do *growth rate* de novos eventos revela que **Cartão (Q4)** e **PIX (Q10)** são os produtos com maior ritmo médio de crescimento (86,1% e 80%, respectivamente), indicando forte capacidade de atrair engajamento adicional ao longo do tempo. **Quote (Q16)** também apresenta desempenho sólido, com 67,4%, enquanto produtos como **Order (Q19)**, **Transferência interna (Q13)** e **Compra no cartão (Q7)** registram médias inferiores a 55%, sugerindo que, embora possam ter tido picos iniciais relevantes, mantêm um ritmo de expansão mais moderado. Esses resultados podem apoiar decisões estratégicas para reforçar o crescimento nos produtos de menor média, seja por meio de melhorias funcionais, campanhas de incentivo ou integração com produtos de maior desempenho.

É importante ressaltar que, como esta análise considera um período curto e um número limitado de observações, a média do *growth rate* pode ser fortemente influenciada por valores iniciais elevados, comuns no momento de lançamento ou primeira adoção, e não refletir de forma consistente a tendência de crescimento no longo prazo.

#### 5. Engajamento por produto

Mede quantos usuários únicos usaram o produto no mês, independente de ser a primeira vez ou não

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
produtos_join <- bind_rows(
  mutate(mau_card_gr,        produto = "Cartão (Q5)"),
  mutate(mau_purchase_gr,          produto = "Compra no cartão (Q8)"),
  mutate(mau_pix_gr,          produto = "PIX (Q11)"),
  mutate(mau_internaltransfers_gr,  produto = "Transf. interna (Q14)"),
  mutate(mau_quotes,       produto = "Quote (Q17)"),
  mutate(mau_orders,       produto = "Order (Q20)")
) |>
  mutate(month = as.Date(paste0(month, "-01"))) |>
  group_by(produto) |>
  mutate(
    max_bar = max(new_users_count, na.rm = TRUE),
    max_gr  = max(growth_rate_percent, na.rm = TRUE),
    scale   = ifelse(is.finite(max_bar/max_gr) & max_gr > 0, max_bar/max_gr, 1),
    growth_scaled = growth_rate_percent * scale
  ) |>
  ungroup()

facet_plot(produtos_join, 'new_users_count', "Total eventos", "Fonte: Q5, Q8, Q11, Q14, Q17, Q20 (Apêndice A)", "Engajamento total - Por produto")
```

1.  **Estabilidade vs. variação brusca** - Produtos como *Order (Q20)* apresentaram estabilidade total, sem crescimento ao longo do período, enquanto outros, como *Quote (Q17)* e *PIX (Q11)*, tiveram oscilações expressivas, incluindo picos de 300% e quedas acima de 50%, indicando comportamento mais volátil dos usuários.

2.  **Quedas acentuadas no engajamento** - *Compra no cartão (Q8)* e *Quote (Q17)* tiveram quedas negativas significativas no *growth rate* (-66,7%), sugerindo períodos com retração relevante no uso, possivelmente por mudanças no produto, sazonalidade ou substituição por outros meios.

3.  **Recuperação após quedas** - Em alguns casos, como *Quote (Q17)* e *PIX (Q11)*, a forte retração foi seguida por recuperação rápida, indicando que o produto pode ter reagido bem a estímulos, campanhas ou fatores externos de incentivo ao uso.

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 

average_plot_gr(produtos_join, "Média do Growth Rate - Engajamento total",  "Fonte: Q5, Q8, Q11, Q14, Q17, Q20 (Apêndice A)")
```

O gráfico mostra que, no engajamento total, **Quote (Q17)** e **PIX (Q11)** se destacam com as maiores médias de *growth rate*, 63,9% e 37,5% respectivamente, indicando crescimento consistente ao longo do período analisado. **Cartão (Q5)** também apresentou crescimento, mas em menor intensidade (16,7%), enquanto **Order (Q20)** permaneceu estável, sem variação média. Já **Compra no cartão (Q8)** e **Transf. interna (Q14)** apresentaram médias negativas, -16,7% e -19,4%, sugerindo tendência de queda no uso desses produtos. Vale destacar que, dado o número reduzido de observações, a média pode ser fortemente influenciada por picos iniciais ou quedas pontuais, o que requer cautela na interpretação.

#### 6. Engajamento multi-produto

Medir quantos usuários estão interagindo com mais de um produto no mesmo período (mês ou ano) e como isso evolui ao longo do tempo. Isso mostra a **amplitude do uso** e pode indicar se os clientes estão se tornando mais integrados ao ecossistema da empresa

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
df_ts <- total_servicos |>
  rename(new_users_count = multi_users)

  growth_metric_plot(df = df_ts,
                     xtitle = "Mês",
                     plottitle = "Engajamento de usuários - multi-produto",
                     xcolname = "mes",
                     ylefttitle = "Usuários usaram >=2 serviços",
                     caption_text = "Fonte: Q21 (Apêndice A)")
  
```

##### 6.1 Produndidade média de uso

Mede o número médio de serviços diferentes usados por usuário no mês.

-   Mostra se os usuários qeu são multi-produto estão aumentando ou reduzindo a variedade de produtos que usam.

-   Compelta o GR: você pode ter crescimento baixo, mas profundidade alta (ou vice-versa).

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
servico_medio_mes |>
  ggplot(aes(x = mes, y = profundidade_media)) +
  geom_line( group = 1) +
  geom_point(color = "#4e66e7", size = 1.3) +
  geom_text( aes(label = profundidade_media),
             vjust = -0.5,
             color = 'black',
             size = 3,
             fontface = "plain",
             show.legend = FALSE
             ) +
  labs( x = "Mês",
        title = "Profundidade média de uso",
        caption = "Fonte: Q22 (Apêndice A)",
        y = "") +
  theme_minimal() +
  theme(
    plot.caption = element_text(hjust = 0, size = 8, color = "gray40")
  )
  
```

A profundidade média de uso apresentou variações significativas ao longo do período analisado. O pico observado em fevereiro de 2025 (1,88 serviços por usuário) indica um aumento pontual no uso combinado de diferentes produtos, possivelmente impulsionado por campanhas específicas ou pelo lançamento de funcionalidades. Após esse momento, a média caiu para cerca de 1,2 serviços por usuário entre março e maio, chegando ao ponto mais baixo em junho de 2025 (1,0), quando praticamente não houve uso de múltiplos serviços. Em julho, observa-se uma leve recuperação, mas ainda distante do desempenho máximo registrado. Essa oscilação evidencia que o engajamento multi-produto não é consistente e reforça a necessidade de ações contínuas para incentivar a adoção de mais de um serviço por parte dos usuários, reduzindo a dependência de eventos pontuais para impulsionar a profundidade de uso.

## Conclusão

A análise indicou que o engajamento multi-produto e o crescimento de uso dos serviços apresentam variações significativas ao longo do período, com picos isolados seguidos por quedas acentuadas. Isso sugere que o aumento no uso combinado de produtos está mais associado a eventos pontuais do que a um comportamento consolidado dos usuários. Para uma visão mais abrangente, é essencial combinar diferentes métricas, não apenas de angajamento (growth rate, profundidade média de uso, desempenho individual por serviço), mas também financeira, como total de valor transacionado, permitindo avaliar o crescimento sob múltiplos ângulos e identificar oportunidades de negócio de forma mais precisa.

## Recomendações

1.  Incentivar uso combinado: criar campanhas específicas que estimulem o uso de múltiplos serviços no mesmo período, oferecendo benefícios progressivos conforme a variedade utilizada.
2.  Focar nos serviços em retração: implementar análises de churn e reengajamento para entender por que determinados produtos estão perdendo usuários.
3.  Explorar momentos de pico: identificar o que gerou os maiores crescimentos passados e replicar estratégias semelhantes em outros períodos.
4.  Monitorar métricas de forma contínua: acompanhar a profundidade média de uso e o growth rate mensal para ajustar rapidamente ações de marketing e produto.
5.  Segmentar por perfil de usuário: diferenciar ações para heavy users e para usuário ocasionais, maximizando o potencial de engajamento e receita.

## Limitações e próximos passos

#### Limitações

-   Dados limitados no tempo: a série histórica é curta, e com grandes espaços entre as datas, o que reduz a capacidade de identificar tendências de longo prazo.

-   Dados de inatividade incompletos: embora seja possível identificar usuários ativos no período, não há regitro explícito da data de inatividade, o qeu limita a precisão de análises de churn, reativação e ciclod e vida do cliente.

-   Eventos externos não identificados: possível campanhas ou mudanças de produto que influenciaram picos e quedas não foram mapeadas no sdados, dificultando a atribuição de causas.

-   Escopo atual centrado em métricas de uso: a análise priorizou indicadores de angajamento, atendendo ao objetivo proposto. Entretando, a incorporação futura de métricas financeiras, como valor total transacionado, pode ampliar a visão sobre o crescimento.

#### Próximos Passos

1.  Ampliar o período de analise para capturar padrões sazonais e evoluções consistentes.
2.  Incluir métricas financeiras como valor transacionado, ticket médio e receita por usuário para enriquecer a visão de crescimento.
3.  Integrar dados de marketing e produto para correlacionar eventos específicos com variações nas métricas de uso e engajamento.
4.  Implementar monitoramento contínuo via dashborad interativo, permitindo acompanhamento em tempo real e rápida reação a mudanças.
5.  Capturar e registrar datas de inatividade para viabilizar análises de churn e estratégias de reengajamento segmentadas.
6.  Realizar segmentação de usuário (novos, recorrentes, heavy users, ocasionais) para orientar ações específicas de retenção e crescimento.

## Apêndices

### Apêndice A - SQL completo

#### Q1 - Growth de usuários com ajuste de inativos mensal

*Objetivo*: medir o crescimento real de usuários ativos ao longo do tempo mensalmente, descontando aqueles que ficaram inativos.

*Entrada*: `users`, `card_purchases`, `pix_transactions`, `internal_transfers` , `quotes`, `card_holder`, `orders`

*Saída*: `table(month, new_users_count, cumulative_users, prev_cumulative, growth_rate_percent, avg_growth_rate_percent, max_growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q1, "Q1", "Growth de usuários com ajuste de inativos mensal")
```

#### Q2 - Growth de usuários com ajuste de inativos anual

*Objetivo*: medir o crescimento real de usuários ativos ao longo do tempo anualmente, descontando aqueles que ficaram inativos.

*Entrada*: `users`, `card_purchases`, `pix_transactions`, `internal_transfers` , `quotes`, `card_holder`, `orders`

*Saída*: `table(year, new_users_count, cumulative_users, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q2, "Q2", "Growth de usuários com ajuste de inativos anual")
```

#### Q3 - Growth da primeira adoção de cartão por usuário

*Objetivo*: Medir a taxa de crescimento da primeira adoção de cartão (primeiro cartão por usuário) ao longo do tempo. A métrica mostra como evolui o número de usuários que passam a ter cartão pela primeira vez em cada mês. Ou seja, crescimento de ativação inicial do produto “cartão”, não de uso recorrente

*Entrada*: `card_holder`

*Saída*: `table(month, new_users_count, cumulative_users, prev_cumulative, growth_rate_percent,avg_growth_rate_percent, max_growth_rate_percent, max_growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q3, "Q3", "Growth de usuários com primeiro cartão por mês")
```

#### Q4 - Growth de Emissão de Novos Cartões

*Objetivo*: mensurar a taxa de crescimento mensal no número de novos cartões emitidos, considerando o total acumulado ao longo do tempo.

*Entrada*: `card_holder`

*Saída*: `table(month, new_cards_count, cumulative_cards, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q4, "Q4", "Growth de emissão de novos cartões por mês")
```

#### Q5 - Growth de usuários ativos no cartão por mês

*Objetivo*: calcular o número de usuários ativos de cartão em cada mês e medir a taxa de crescimento percentual em relação ao mês anterior.

*Entrada*: `card_holder`

*Saída*: `table(month, new_users_count, prev_users_active, growth_rate_percent, avg, growth_rate_percent, max_growth_rate_percent, max_growth_period)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q5, "Q5", "Growth de usuários ativos no cartão por mês")
```

#### Q6 - Growth da primeira compra em cartão dos usuários por mês

*Objetivo*: calcular a taxa de crescimento mensal de usuários que realizaram sua primeira compra com cartão, considerando o número acumulado ao longo do tempo.

*Entrada*: `card_purchase`

*Saída*: `table(month, new_users_count, cumulative_users, prev_cumulative, growth_rate_percent, avg_growth_rate_percent, max_growth_rate_percent, max_growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q6, "Q6", "Growth de primeira compra em cartão por mês")
```

#### Q7 - Growth de compras em cartões BIPA por mês

*Objetivo*: Medir a evolução mensal no volume de compras realizadas com cartão, calculando a taxa de crescimento em relação ao mês anterior com base no número acumulado de transações.

*Entrada*: `card_purchase`

*Saída*: `table(month, new_purchase_count, cumulative_purchase, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q7, "Q7", "Growth de compras em cartão BIPA por mês")
```

#### Q8 - Growth de usuários que compram com cartão no mês

*Objetivo*: calcular, mês a mês, quantos usuários únicos fizeram ao menos uma compra com cartão e a sua taxa de crescimento.

*Entrada*: `card_purchase`

*Saída*: `table(month, new_users_count, prev_users_active, growth_rate_percent, avg, growth_rate_percent, max_growth_rate_percent, max_growth_period)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q8, "Q8", "Growth de usuários que compram com cartão por mês")
```

#### Q9 - Growth de usuários que realizaram a primeira transação PIX por mês

*Objetivo*: Medir o crescimento no número de usuários que realizaram sua primeira transação via PIX, calculando a taxa de crescimento mensal em relação ao mês anterior com base no volume acumulado.

*Entrada*: `pix_transactions`

*Saída*: `table(month, new_users_count, cumulative_users, prev_cumulative, growth_rate_percent, avg_growth_rate_percent, max_growth_rate_percent, max_growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q9, "Q9", "Growth de primeria transação PIX por mês")
```

#### Q10 - Growth de transações Pix por mês

*Objetivo*: Medir o crescimento no número total de transações PIX realizadas, calculando a taxa de crescimento mensal em relação ao volume acumulado do mês anterior.

*Entrada*: `pix_transactions`

*Saída*: `table(month, new_pix_count, cumulative_pix, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q10, "Q10", "Growth transação PIX por mês")
```

#### Q11 - Growth de usuários ativos em transações Pix por mês

*Objetivo*: calcular, para cada mês, o número de usuários únicos que realizaram ao menos uma transação PIX e calcular a taxa de crescimento percentual desse volume em relação ao mês anterior, permitindo acompanhar a evolução do engajamento mensal do uso de PIX.

*Entrada*: `pix_transactions`

*Saída*: `table(month, new_users_count, prev_users_active, growth_rate_percent, avg, growth_rate_percent, max_growth_rate_percent, max_growth_period)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q11, "Q11", "Growth de usuários ativos usando PIX por mês")
```

#### Q12 - Growth de usuários com primeira transação interna por mês

*Objetivo*: Medir o crescimento no número de usuários que realizaram sua primeira transação interna (seja como remetente ou destinatário), calculando a taxa de crescimento mensal em relação ao total acumulado até o mês anterior.

*Entrada*: `internal_transfers`

*Saída*: `table(month, new_users_count, cumulative_usrs, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q12, "Q12", "Growth transação interna do usuário por mês")
```

#### Q13. Growth de transações internas por mês

*Objetivo*: Medir o crescimento no número total de transações internas realizadas, calculando a taxa de crescimento mensal em relação ao volume acumulado até o mês anterior.

*Entrada*: `internal_transfers`

*Saída*: `table(month, new_it_count, cumulative_it, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q13, "Q13", "Growth transação interna por mês")
```

#### Q14 - Growth de usuários ativos em transações internas por mês

*Objetivo*: Calcular, mensalmente, a quantidade de usuários únicos que participaram de transações internas, seja como remetentes ou destinatários, e medir a taxa de crescimento percentual desse volume em relação ao mês anterior, permitindo avaliar a evolução do uso da funcionalidade de transferências internas.

*Entrada*: `internal_transactions`

*Saída*: `table(month, new_users_count, prev_users_active, growth_rate_percent, avg, growth_rate_percent, max_growth_rate_percent, max_growth_period)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q14, "Q14", "Growth de usuários ativos fazerndo transação interna por mês")
```

#### Q15 - Growth de usuários com primeira criação de quote por mês

*Objetivo*: Medir o crescimento no número de usuários que criaram sua primeira quote no período, calculando a taxa de cresicmento mensal em relação ao total acumulado até o mês anterior.

*Entrada*: `quotes`

*Saída*: `table(month, new_users_count, cumulative_usrs, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q15, "Q15", "Growth de usuários criando quotes por mês")
```

#### Q16 - Growth de quotes criadas por mês

*Objetivo*: Medir o crescimento no núemro total de quotes criadas por mês, calculando a taxa de crescimento em relação ao total acumulado até o mês anterior.

*Entrada*: `quotes`

*Saída*: `table(month, new_quotes_count, cumulative_quotes, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q16, "Q16", "Growth de quotes por mês")
```

#### Q17 - Growth de usuários ativos gerando quotes por mês

*Objetivo*: Identificar, para cada mês, o número de usuários únicos que criaram pelo menos uam quote e calcular a taxa percentual de crescimento desse volume em relação ao mês anterior, permitindo acompanhar a evolução do engajamento dos usuários com a funcionalidade de geração de cotações.

*Entrada*: `quotes`

*Saída*: `table(month, new_users_count, prev_users_active, growth_rate_percent, avg, growth_rate_percent, max_growth_rate_percent, max_growth_period)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q17, "Q17", "Growth de usuários ativos gerando quotes por mês")
```

#### Q18 - Growth de usuários realizando a primeira order por mês

*Objetivo*: Medir o crescimento no número de usuários que realizaram seu primeiro *order* a cada mês, calculando a taxa de crescimento em relação ao acumulado de meses anteriores.

*Entrada*: `orders`

*Saída*: `table(month, new_users_count, cumulative_usrs, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q18, "Q18", "Growth de usuários realiznado a primeira order por mês")
```

#### Q19 - Growth de orders criadas por mês

*Objetivo*: Medir o crescimento no número de orders criadas por mês, calculando a taxa de crescimento em relação ao acumulado do mês anterior.

*Entrada*: `orders`

*Saída*: `table(month, new_order_count, cumulative_order, prev_cumulative, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q19, "Q19", "Growth de orders criadas por mês")
```

#### Q20 - Growth de usuários ativos gerando orders por mês

*Objetivo*: Calcular, mês a mês, o total de usuários únicos qeu realizaram pelo menos uma order e determinar a variçaõ percentual em relação ao mês anterior, possibilitando monitorar o engajamento dos usuários com a funcionalidade de criação ao longo do tempo.

*Entrada*: `order`

*Saída*: `table(month, new_users_count, prev_users_active, growth_rate_percent, avg, growth_rate_percent, max_growth_rate_percent, max_growth_period)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q20, "Q20", "Growth de usuários ativos gerando orders  por mês")
```

#### Q21 - Growth de usuários multi-produto por mês

*Objetivo*: Calcular, por mês, o Growth Rate de engajaemnto multi-produto, ou seja, como cresce (ou cai) a quantidade de usuários que usam $\geq2$ serviços diferentes no mesmo mês.

*Entrada*: `quotes`, `orders`, `card_purchases`, `pix_transactions`, `internal_transfers`, `card_holder`

*Saída*: `table(mes, multi_users, prev_multi_users, growth_rate_percent)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q21, "Q21", "Growth de usuários multi_produto por mês")
```

#### Q22 - Profundidade média de multi-uso

*Objetivo*: Medir a profundidade de engajamento: quantos serviços diferentes, em média, cada usuário utiliza em cada mês. Isso indica se os usuários estão ampliando (ou não) a variedade de produtos/operações uados no ecossistema.

*Entrada*: `quotes`, `orders`, `card_purchases`, `pix_transactions`, `internal_transfers`, `card_holder`

*Saída*: `table(mes, profundidade_media)`

```{r}
#| message: false
#| error: false
#| echo: false
#| warning: false 
show_sql(Q22, "Q22", "Profundidade média de multi-uso por mês")
```

### Apêndice B - Reprodutibilidade

Todos os códigos utilizados nesta análise estão disponíveis no repositório público:

[GitHub - Case Técnico BIPA](https://github.com/erikastats/Criptocoin-Analysis)

Abaixo, segue o mapeamento entre as etapas da análise que proporcionaram este relatório ser feito e os respectivos arquivos de código no repositório:

| Etapa da Análise | Descrição | Localização no Repositório |
|------------------|------------------------------------|------------------|
| 1\. Exploração inicial dos dados | Carregamento, verificação de consistência e análise exploratória inicial | `EDA_BIPA_full.qmd` |
| 2\. Criação do banco de dados | Código para criar o bando de dados SQLite | `ccreating_db.R` |
| 3\. Funções utilizadas | Script para criação de funções de plots e queries | `funcoes_ciptocoin_analysis.R` |
| 4\. Criação das queries | Criação das queries e tabelas resultantes | `build_tables.R` |
| 5\. Conclusões e recomendações | Consolidação dos insights | `Érika Soares Machado Borelli2.qmd` |

**Requisitos para execução:**

-   Linguagem: SQL (SQLite), R (versão mínima 4.4.3) e Rstudio

-   Pacotes R utilizados: `ggplot2`, `gt`, `hrbrthemes`, `dplyr`, `tidyr`, `scales`, `glue`, `DBI`, `RSQLite`, `readr`

-   Passo a passo:

    1.  Clonar o repositório.
    2.  Executar o script #5 (ele já incorpora os outros).
    3.  Comparar os resultados obtidos com os apresentados no relatório.
